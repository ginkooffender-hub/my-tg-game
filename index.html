<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Golden Tree Premium</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold-gradient: linear-gradient(135deg, #ffdf7e 0%, #f59e0b 50%, #b45309 100%);
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --bg-color: #020617;
        }

        body {
            margin: 0; padding: 0; font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at 50% -20%, #1e293b 0%, #020617 80%);
            color: white; height: 100vh; overflow: hidden;
            user-select: none; -webkit-tap-highlight-color: transparent;
        }

        .container {
            display: flex; flex-direction: column; height: 100vh;
            padding: 20px 20px 100px 20px; box-sizing: border-box;
        }

        /* --- –í–ï–†–•–ù–ò–ô –°–¢–ï–ö–õ–Ø–ù–ù–´–ô –ë–õ–û–ö --- */
        .header-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            margin-bottom: 25px;
        }

        .profit-label {
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 600; opacity: 0.7;
            letter-spacing: 2px; text-transform: uppercase; margin-bottom: 10px;
        }
        .profit-label span { margin-left: 8px; }

        .balance-main {
            font-size: 42px; font-weight: 800;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 5px 0; letter-spacing: -1px;
        }

        .level-sub {
            font-size: 13px; font-weight: 400; opacity: 0.5;
            letter-spacing: 1px;
        }

        /* --- –ì–õ–ê–í–ù–´–ô –ë–õ–û–ö –° –î–ï–†–ï–í–û–ú --- */
        .tree-viewport {
            flex: 1; display: flex; align-items: center; justify-content: center;
            position: relative;
        }

        .tree-frame {
            width: 100%; max-width: 320px; aspect-ratio: 1/1;
            background-image: url('https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?auto=format&fit=crop&q=80&w=1000'); /* –§–æ–Ω –ª–µ—Å–∞ */
            background-size: cover; background-position: center;
            border-radius: 40px;
            position: relative;
            border: 2px solid #f59e0b;
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.4), inset 0 0 20px rgba(0,0,0,0.8);
            overflow: hidden;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.1s;
        }

        .tree-frame:active { transform: scale(0.96); }

        .tree-image {
            width: 90%; height: 90%; object-fit: contain;
            filter: drop-shadow(0 0 20px rgba(245, 158, 11, 0.6));
            z-index: 2;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —á–∞—Å—Ç–∏—Ü –∏ —Å–≤–µ—á–µ–Ω–∏—è */
        .glow-overlay {
            position: absolute; inset: 0;
            background: radial-gradient(circle, rgba(245, 158, 11, 0.2) 0%, transparent 70%);
            pointer-events: none; animation: pulse 4s infinite;
        }

        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* --- –≠–ù–ï–†–ì–ò–Ø --- */
        .energy-section { margin-top: 30px; width: 100%; }

        .energy-header {
            display: flex; justify-content: space-between;
            font-size: 13px; font-weight: 800; letter-spacing: 1px;
            margin-bottom: 10px; padding: 0 5px;
        }

        .energy-bar-container {
            height: 14px; background: rgba(255,255,255,0.05);
            border-radius: 20px; border: 1px solid var(--glass-border);
            overflow: hidden; position: relative;
        }

        .energy-bar-fill {
            height: 100%; width: 100%;
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.5);
            transition: width 0.3s ease;
        }

        /* --- –ù–ê–í–ò–ì–ê–¶–ò–Ø --- */
        .nav-panel {
            position: fixed; bottom: 0; left: 0; right: 0;
            height: 85px; background: rgba(2, 6, 23, 0.9);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-top: 1px solid var(--glass-border);
            display: flex; justify-content: space-around; align-items: center;
            padding-bottom: 20px;
        }

        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            opacity: 0.4; transition: 0.3s; cursor: pointer;
        }

        .nav-item.active {
            opacity: 1;
        }

        .nav-item.active .nav-icon {
            filter: drop-shadow(0 0 8px rgba(245, 158, 11, 0.8));
        }

        .nav-icon { font-size: 24px; margin-bottom: 5px; }
        .nav-text { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞ */
        .tap-particle {
            position: absolute; color: #ffdf7e; font-weight: 800; font-size: 30px;
            pointer-events: none; animation: floatUp 0.8s ease-out forwards;
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.8); z-index: 100;
        }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-150px) scale(1.5); opacity: 0; } }

    </style>
</head>
<body>

    <div class="container">
        <div class="header-card">
            <div class="profit-label">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="3">
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a2 2 0 0 1 2.83 0l.3.3a2 2 0 0 1 0 2.83l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 0 1.4l-5.66 5.66a1 1 0 0 1-1.41 0l-1.66-1.66a1 1 0 0 1 0-1.41l.59-.59a2 2 0 0 0 0-2.83l-1-1a2 2 0 0 0-2.83 0l-.59.59a1 1 0 0 1-1.41 0L3.05 18.2a1 1 0 0 1 0-1.41l5.66-5.66a1 1 0 0 0 0-1.4l-1.6-1.6a1 1 0 0 0-1.4 0L1.94 11.9a2 2 0 0 1-2.83 0l-.3-.3a2 2 0 0 1 0-2.83l3.77-3.77a1 1 0 0 0 0-1.4L1 2.04a1 1 0 0 0-1.4 0l-5.66 5.66"/>
                </svg>
                <span>–ü–†–ò–ë–´–õ–¨</span>
            </div>
            <div class="balance-main" id="balance">0</div>
            <div class="level-sub" id="levelName">–£–†–û–í–ï–ù–¨: –†–û–°–¢–û–ö</div>
        </div>

        <div class="tree-viewport">
            <div class="tree-frame" id="clickTarget">
                <div class="glow-overlay"></div>
                <img src="" id="treeImg" class="tree-image" alt="Golden Tree">
            </div>
        </div>

        <div class="energy-section">
            <div class="energy-header">
                <span>–≠–ù–ï–†–ì–ò–Ø</span>
                <span id="energyText">100/100</span>
            </div>
            <div class="energy-bar-container">
                <div class="energy-bar-fill" id="energyFill"></div>
            </div>
        </div>
    </div>

    <div class="nav-panel">
        <div class="nav-item active">
            <div class="nav-icon">üå≥</div>
            <div class="nav-text">–ò–≥—Ä–∞</div>
        </div>
        <div class="nav-item">
            <div class="nav-icon">üöÄ</div>
            <div class="nav-text">–ë—É—Å—Ç—ã</div>
        </div>
        <div class="nav-item">
            <div class="nav-icon">üë•</div>
            <div class="nav-text">–î—Ä—É–∑—å—è</div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.backgroundColor = "#020617";
        tg.headerColor = "#020617";

        const userId = (tg.initDataUnsafe && tg.initDataUnsafe.user) ? tg.initDataUnsafe.user.id : 'guest';
        const SAVE_KEY = `mTree_premium_v1_${userId}`;

        // –¢–≤–æ–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç–≤–æ–ª—é—Ü–∏—é
        const imgs = [
            "https://i.ibb.co/PzVbNnPJ/image.png",
            "https://i.ibb.co/s9HrPnmZ/image.png",
            "https://i.ibb.co/SDZ6wD9b/image.png",
            "https://i.ibb.co/QFwFTZR2/image.png",
            "https://i.ibb.co/FkBT0nPf/image.png"
        ];
        const names = ["–†–û–°–¢–û–ö", "–ö–£–°–¢", "–ú–û–õ–û–î–û–ï –î–ï–†–ï–í–û", "–ë–û–õ–¨–®–û–ï –î–ï–†–ï–í–û", "–ó–û–õ–û–¢–û–ï –î–†–ï–í–û"];

        let state = JSON.parse(localStorage.getItem(SAVE_KEY)) || {
            coins: 0, power: 1, energy: 100, maxEnergy: 100, treeLvl: 0
        };

        function updateUI() {
            document.getElementById('balance').textContent = Math.floor(state.coins).toLocaleString();
            document.getElementById('levelName').textContent = `–£–†–û–í–ï–ù–¨: ${names[state.treeLvl]}`;
            document.getElementById('treeImg').src = imgs[state.treeLvl];
            document.getElementById('energyText').textContent = `${Math.floor(state.energy)}/${state.maxEnergy}`;
            document.getElementById('energyFill').style.width = `${(state.energy / state.maxEnergy) * 100}%`;
            
            localStorage.setItem(SAVE_KEY, JSON.stringify(state));
        }

        function handleTap(e) {
            if (state.energy < 1) {
                tg.HapticFeedback.notificationOccurred('warning');
                return;
            }

            const gain = state.power * (1 + state.treeLvl * 0.5);
            state.coins += gain;
            state.energy -= 1;

            // –ß–∞—Å—Ç–∏—Ü—ã –∫–ª–∏–∫–∞
            const p = document.createElement('div');
            p.className = 'tap-particle';
            p.textContent = `+${Math.floor(gain)}`;
            const x = e.clientX || (e.touches ? e.touches[0].clientX : window.innerWidth/2);
            const y = e.clientY || (e.touches ? e.touches[0].clientY : window.innerHeight/2);
            p.style.left = `${x}px`;
            p.style.top = `${y}px`;
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);

            tg.HapticFeedback.impactOccurred('medium');
            updateUI();
        }

        const target = document.getElementById('clickTarget');
        target.addEventListener('touchstart', (e) => { e.preventDefault(); handleTap(e); });
        target.addEventListener('mousedown', (e) => { handleTap(e); });

        // –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(() => {
            if (state.energy < state.maxEnergy) {
                state.energy = Math.min(state.maxEnergy, state.energy + 0.3);
                updateUI();
            }
        }, 1000);

        updateUI();
    </script>
</body>
</html>
