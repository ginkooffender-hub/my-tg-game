<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Money Tree</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root{
--bg:#0f1115;
--card:rgba(255,255,255,0.06);
--gold:#f5c451;
--green:#3ddc97;
}

*{box-sizing:border-box}
body{
margin:0;
font-family:system-ui,Arial;
background:radial-gradient(circle at top,#1a1d24,#0b0d12);
color:white;
overflow:hidden;
}

.app{
padding:16px;
max-width:520px;
margin:auto;
}

.card{
background:var(--card);
backdrop-filter:blur(12px);
border-radius:18px;
padding:14px;
box-shadow:0 10px 30px rgba(0,0,0,.4), inset 0 1px rgba(255,255,255,.05);
}

.header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:10px;
}

.energy{
height:14px;
border-radius:10px;
background:#1e222b;
overflow:hidden;
box-shadow:inset 0 2px 6px rgba(0,0,0,.6);
}

.energy-bar{
height:100%;
background:linear-gradient(90deg,var(--green),#7affc1);
box-shadow:0 0 10px var(--green);
transition:width .3s;
}

.tree-area{
position:relative;
height:360px;
display:flex;
justify-content:center;
align-items:center;
}

.tree{
font-size:120px;
transition:transform .25s;
user-select:none;
cursor:pointer;
animation:breath 3s infinite ease-in-out;
}

@keyframes breath{
0%,100%{transform:scale(1)}
50%{transform:scale(1.05)}
}

.level{
text-align:center;
margin-top:6px;
opacity:.8;
}

.coin{
position:absolute;
font-size:22px;
animation:fall 900ms forwards;
}

@keyframes fall{
0%{transform:translateY(-10px) scale(.6);opacity:1}
100%{transform:translateY(120px) scale(1);opacity:0}
}

.float{
position:absolute;
font-weight:700;
color:var(--gold);
text-shadow:0 0 10px gold,0 0 20px gold;
animation:float 900ms forwards;
}

@keyframes float{
0%{transform:translateY(0);opacity:1}
100%{transform:translateY(-80px);opacity:0}
}

.buttons{
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
margin-top:12px;
}

.btn{
padding:14px;
border-radius:14px;
background:linear-gradient(145deg,#1b1f27,#0f1218);
box-shadow:inset 0 2px 4px rgba(255,255,255,.05),0 6px 16px rgba(0,0,0,.6);
text-align:center;
}

.prestige{
position:absolute;
inset:0;
pointer-events:none;
border-radius:50%;
filter:blur(40px);
opacity:0;
background:radial-gradient(circle,gold,transparent 60%);
transition:opacity .4s;
}

</style>
</head>
<body>
<div class="app">

<div class="card">

<div class="header">
<div>Coins: <span id="coins">0</span></div>
<div>LVL <span id="level">1</span></div>
</div>

<div class="energy">
<div class="energy-bar" id="energyBar"></div>
</div>

<div class="tree-area" id="treeArea">
<div class="prestige" id="prestige"></div>
<div class="tree" id="tree">ðŸŒ±</div>
</div>

<div class="level">Money Tree</div>

</div>

<div class="buttons">
<div class="btn" onclick="buyPower()">Tap Power</div>
<div class="btn" onclick="buyEnergy()">Max Energy</div>
</div>

</div>

<script>
const tg = window.Telegram.WebApp
if(tg){tg.expand()}

let state = JSON.parse(localStorage.getItem('moneyTree')) || {
coins:0,
power:1,
energy:100,
maxEnergy:100,
level:1,
auto:0,
last:Date.now()
}

const tree = document.getElementById('tree')
const area = document.getElementById('treeArea')

function save(){
localStorage.setItem('moneyTree',JSON.stringify(state))
}

function updateUI(){
coins.textContent=Math.floor(state.coins)
level.textContent=state.level
energyBar.style.width=(state.energy/state.maxEnergy*100)+'%'
updateTreeVisual()
}

function updateTreeVisual(){
let stage='ðŸŒ±'
if(state.level>=5) stage='ðŸŒ¿'
if(state.level>=10) stage='ðŸŒ³'
if(state.level>=20) stage='ðŸŒ³'
if(state.level>=30) stage='ðŸŒ³'

tree.textContent=stage

let scale=1+state.level*0.05

tree.style.transform='scale('+scale+')'

if(state.coins>10000){
prestige.style.opacity=1
}else{
prestige.style.opacity=0
}
}

function spawnCoin(x,y){
const c=document.createElement('div')
c.className='coin'
c.textContent='ðŸª™'
c.style.left=x+'px'
c.style.top=y+'px'
area.appendChild(c)
setTimeout(()=>c.remove(),900)
}

function spawnText(x,y,val){
const t=document.createElement('div')
t.className='float'
t.textContent='+'+val

t.style.left=x+'px'
t.style.top=y+'px'
area.appendChild(t)
setTimeout(()=>t.remove(),900)
}

function clickTree(e){
if(state.energy<=0) return

state.energy--
state.coins+=state.power

let rect=area.getBoundingClientRect()
let x=e.clientX-rect.left
let y=e.clientY-rect.top

spawnCoin(x,y)
spawnText(x,y,state.power)

tree.style.transform+=' rotate('+(Math.random()*6-3)+'deg)'

if(tg?.HapticFeedback) tg.HapticFeedback.impactOccurred('light')

checkLevel()
save()
updateUI()
}

function checkLevel(){
let lvl=Math.floor(state.coins/200)+1
if(lvl>state.level){
state.level=lvl
if(tg?.HapticFeedback) tg.HapticFeedback.notificationOccurred('success')
}
}

function buyPower(){
let cost=50*state.power
if(state.coins>=cost){
state.coins-=cost
state.power++
}
updateUI()
save()
}

function buyEnergy(){
let cost=80
if(state.coins>=cost){
state.coins-=cost
state.maxEnergy+=20
}
updateUI()
save()
}

setInterval(()=>{
state.energy=Math.min(state.maxEnergy,state.energy+1)
state.coins+=state.auto
updateUI()
},1000)

function offline(){
let now=Date.now()
let diff=(now-state.last)/1000
state.coins+=diff*state.auto
state.last=now
}

offline()
updateUI()

area.addEventListener('click',clickTree)

</script>
</body>
</html>
